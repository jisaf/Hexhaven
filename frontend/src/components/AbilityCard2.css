/**
 * AbilityCard2 CSS (Issue #217)
 *
 * Layout: Header (small) | Top Action | Split (half) | Bottom Action
 * Right column: Initiative (top) | Level (middle)
 *
 * Uses em units for responsive scaling.
 */

/* ========== CARD CONTAINER ========== */

.ability-card2 {
  display: grid;
  grid-template-columns: 1fr auto;
  width: 100%;
  height: 100%;
  background: #2c3e50;
  border: 0.15em solid #2c3e50;
  border-radius: 0.5em;
  box-shadow: 0 0.2em 0.4em rgba(0, 0, 0, 0.3);
  overflow: hidden;
  cursor: pointer;
  /* Prevent all text selection and touch callouts */
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  /* Allow panning/scrolling, disable double-tap zoom */
  touch-action: manipulation;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  position: relative;
  font-size: inherit;
  /* Enable container queries for responsive content sizing */
  container-type: size;
  container-name: card;
}


.ability-card2:hover:not(.disabled) {
  transform: translateY(-0.15em);
  box-shadow: 0 0.3em 0.6em rgba(0, 0, 0, 0.4);
}

.ability-card2:focus {
  outline: 0.1em solid var(--card-selected-border, #2ecc71);
  outline-offset: 0.1em;
}

.ability-card2.selected {
  border-color: var(--card-selected-border, #2ecc71);
  box-shadow: 0 0 0.8em rgba(46, 204, 113, 0.5);
}

.ability-card2.disabled {
  opacity: 0.5;
  cursor: not-allowed;
  filter: grayscale(30%);
}

/* ========== MAIN CONTENT (LEFT COLUMN) ========== */

.card2-content {
  display: grid;
  grid-template-rows: auto 1fr auto 1fr;
  height: 100%;
  background: #ffffff;
  border-radius: 0.4em 0 0 0.4em;
  overflow: hidden;
}

/* Header - small, minimal padding */
.card2-header {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.15em 0.3em;
  background: rgba(44, 62, 80, 0.08);
  border-bottom: 0.05em solid rgba(44, 62, 80, 0.1);
}

.card2-name {
  font-size: 0.6em;
  font-weight: bold;
  color: #2c3e50;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Top action section */
.card2-top-section {
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.card2-top-section.highlighted {
  background: rgba(46, 204, 113, 0.12);
}

/* Split divider - half height, minimal */
.card2-split {
  display: flex;
  align-items: center;
  padding: 0.1em 0.3em;
  flex-shrink: 0;
}

.card2-split-line {
  flex: 1;
  height: 0.1em;
  background: linear-gradient(to right, transparent 0%, #bdc3c7 20%, #bdc3c7 80%, transparent 100%);
}

/* Bottom action section */
.card2-bottom-section {
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.card2-bottom-section.highlighted {
  background: rgba(46, 204, 113, 0.12);
}

/* Issue #411: Clickable action sections for card action selection */
.card2-top-section.clickable,
.card2-bottom-section.clickable {
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
  border-radius: 0.3em;
}

.card2-top-section.clickable:hover:not(.section-disabled),
.card2-bottom-section.clickable:hover:not(.section-disabled) {
  background: rgba(201, 164, 68, 0.25);
}

.card2-top-section.clickable:active:not(.section-disabled),
.card2-bottom-section.clickable:active:not(.section-disabled) {
  transform: scale(0.98);
  background: rgba(201, 164, 68, 0.35);
}

/* Disabled section styling */
.card2-top-section.section-disabled,
.card2-bottom-section.section-disabled {
  opacity: 0.4;
  cursor: not-allowed;
  pointer-events: none;
}

/* ========== RIGHT COLUMN ========== */

.card2-right-column {
  display: flex;
  flex-direction: column;
  width: 1.6em;
  background: #2c3e50;
}

/* Initiative - top of right column */
.card2-initiative {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7em;
  font-weight: bold;
  color: #ecf0f1;
  padding: 0.3em 0;
  background: rgba(0, 0, 0, 0.2);
}

/* Right column icons for each action */
.card2-right-icons {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  flex: 1;
  padding: 0.15em 0;
}

.card2-right-icons .card-icons {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.15em;
}

.card2-right-icons .card-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.1em;
  border-radius: 0.15em;
  font-size: 0.55em;
}

.card2-right-icons .card-icon .ra {
  font-size: 1.2em;
}

.card2-right-icons .card-icon.loss {
  background: rgba(231, 76, 60, 0.3);
}

.card2-right-icons .card-icon.persistent {
  background: rgba(52, 152, 219, 0.3);
}

.card2-right-icons .card-icon.xp {
  background: rgba(241, 196, 15, 0.3);
}

.card2-right-icons .card-icon .xp-value {
  font-size: 0.9em;
  margin-left: 0.1em;
  font-weight: bold;
}

/* ========== LEVEL INDICATOR (top left, faded) ========== */

.card2-level-indicator {
  position: absolute;
  top: 0.25em;
  left: 0.25em;
  font-size: 0.5em;
  font-weight: bold;
  color: rgba(44, 62, 80, 0.25);
  z-index: 5;
}

/* ========== SELECTION INDICATOR ========== */

.card2-selection-indicator {
  position: absolute;
  bottom: 0.15em;
  left: 0.15em;
  width: 0.9em;
  height: 0.9em;
  background: var(--card-selected-border, #2ecc71);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.card2-checkmark {
  color: white;
  font-size: 0.55em;
  font-weight: bold;
}

/* ========== HIGHLIGHT STATES ========== */

.ability-card2.highlight-top .card2-top-section {
  background: rgba(46, 204, 113, 0.15);
}

.ability-card2.highlight-bottom .card2-bottom-section {
  background: rgba(46, 204, 113, 0.15);
}

/* ========== CARD ZOOM MODAL ========== */

.card-zoom-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: fadeIn 0.15s ease-out;
  touch-action: none;
  -webkit-touch-callout: none;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.card-zoom-modal {
  /* Card aspect ratio approximately 2:3 (width:height) */
  width: min(85vw, 320px);
  height: min(80vh, 480px);
  animation: zoomIn 0.2s ease-out;
}

@keyframes zoomIn {
  from {
    transform: scale(0.85);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* Zoomed card styles - full opacity, proper sizing */
.ability-card2.zoomed {
  /* Base font size for zoomed card - larger for readability */
  font-size: clamp(14px, 4vw, 20px);
  pointer-events: none;
  cursor: default;
  opacity: 1 !important;
  filter: none !important;
  box-shadow: 0 0.5em 2em rgba(0, 0, 0, 0.6);
  border-width: 3px;
}

/* Zoomed card header */
.ability-card2.zoomed .card2-header {
  padding: 0.4em 0.5em;
}

.ability-card2.zoomed .card2-name {
  font-size: 0.9em;
  letter-spacing: 0.02em;
}

/* Zoomed card right column */
.ability-card2.zoomed .card2-right-column {
  width: 2.2em;
}

.ability-card2.zoomed .card2-initiative {
  font-size: 1em;
  padding: 0.4em 0;
}

.ability-card2.zoomed .card2-right-icons .card-icon {
  font-size: 0.7em;
  padding: 0.15em;
}

.ability-card2.zoomed .card2-right-icons .card-icon .ra {
  font-size: 1.3em;
}

/* Zoomed card level indicator */
.ability-card2.zoomed .card2-level-indicator {
  font-size: 0.7em;
  top: 0.4em;
  left: 0.4em;
}

/* Zoomed card action content */
.ability-card2.zoomed .action-row-layout {
  padding: 0.4em;
}

.ability-card2.zoomed .action-row-main {
  font-size: 1em;
  gap: 0.5em;
}

.ability-card2.zoomed .action-row-icon {
  font-size: 1.3em;
}

.ability-card2.zoomed .action-row-value {
  font-size: 1.4em;
}

.ability-card2.zoomed .action-row-range {
  font-size: 0.9em;
}

.ability-card2.zoomed .action-row-effects {
  gap: 0.3em;
  margin-top: 0.3em;
}

.ability-card2.zoomed .action-row-effect-tag {
  font-size: 0.65em;
  padding: 0.15em 0.35em;
}

.ability-card2.zoomed .action-row-element {
  font-size: 0.8em;
  padding: 0.15em 0.4em;
}
